<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extending eventglm • eventglm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Extending eventglm">
<meta property="og:description" content="eventglm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eventglm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-analysis.html">Examples of using eventglm and interpreting the results</a>
    </li>
    <li>
      <a href="../articles/extenstions.html">Extending eventglm</a>
    </li>
    <li>
      <a href="../articles/stata-sas-comparason.html">Comparison to other software</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sachsmc/eventglm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Extending eventglm</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sachsmc/eventglm/blob/HEAD/vignettes/extenstions.Rmd" class="external-link"><code>vignettes/extenstions.Rmd</code></a></small>
      <div class="hidden name"><code>extenstions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sachsmc.github.io/eventglm/" class="external-link">eventglm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'eventglm'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:survival':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     colon, mgus2</span></span></code></pre></div>
<div class="section level2">
<h2 id="pseudo-observation-computation-modules">Pseudo observation computation modules<a class="anchor" aria-label="anchor" href="#pseudo-observation-computation-modules"></a>
</h2>
<p>As of version 1.1.0, <code>cumincglm</code> and <code>rmeanglm</code>
expect the argument <code>model.censoring</code> to be a function. This
function is the workhorse that does the computation of the pseudo
observations that are later used in the generalized linear model. A
number of computation methods are built in as “modules” in the file
called “pseudo-modules.R”. Let us take a look at an example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">eventglm</span><span class="fu">::</span><span class="va"><a href="../reference/pseudo_independent.html">pseudo_independent</a></span></span>
<span><span class="co">#&gt; function (formula, time, cause = 1, data, type = c("cuminc", </span></span>
<span><span class="co">#&gt;     "survival", "rmean"), formula.censoring = NULL, ipcw.method = NULL) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     margformula &lt;- update.formula(formula, . ~ 1)</span></span>
<span><span class="co">#&gt;     mr &lt;- model.response(model.frame(margformula, data = data))</span></span>
<span><span class="co">#&gt;     stopifnot(attr(mr, "type") %in% c("right", "mright"))</span></span>
<span><span class="co">#&gt;     marginal.estimate &lt;- survival::survfit(margformula, data = data)</span></span>
<span><span class="co">#&gt;     if (type == "cuminc") {</span></span>
<span><span class="co">#&gt;         POi &lt;- get_pseudo_cuminc(marginal.estimate, time, cause, </span></span>
<span><span class="co">#&gt;             mr)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else if (type == "survival") {</span></span>
<span><span class="co">#&gt;         if (marginal.estimate$type != "right") {</span></span>
<span><span class="co">#&gt;             stop("Survival estimand not available for outcome with censoring type", </span></span>
<span><span class="co">#&gt;                 marginal.estimate$type)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         POi &lt;- 1 - get_pseudo_cuminc(marginal.estimate, time, </span></span>
<span><span class="co">#&gt;             cause, mr)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else if (type == "rmean") {</span></span>
<span><span class="co">#&gt;         POi &lt;- get_pseudo_rmean(marginal.estimate, time, cause, </span></span>
<span><span class="co">#&gt;             mr)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     POi</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x60ec837b7500&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:eventglm&gt;</span></span></code></pre></div>
<p>This function, and any pseudo observation module, must take the same
named arguments (though they do not all have to be used), and return a
vector of pseudo observations.</p>
</div>
<div class="section level2">
<h2 id="custom-computation-functions">Custom computation functions<a class="anchor" aria-label="anchor" href="#custom-computation-functions"></a>
</h2>
<div class="section level3">
<h3 id="example-parametric-pseudo-observations">Example: Parametric pseudo observations<a class="anchor" aria-label="anchor" href="#example-parametric-pseudo-observations"></a>
</h3>
<p>Let us see how to define a custom function for computation of pseudo
observations. In this first example, we will fit a parametric survival
model with <code>survreg</code> marginally and do jackknife leave one
out estimates. This may be useful if there is interval censoring, for
example.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pseudo_parametric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">time</span>, <span class="va">cause</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">data</span>,</span>
<span>                        <span class="va">type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cuminc"</span>, <span class="st">"survival"</span>, <span class="st">"rmean"</span><span class="op">)</span>,</span>
<span>                        <span class="va">formula.censoring</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">ipcw.method</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">margformula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">update.formula</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">.</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.response</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></span><span class="op">(</span><span class="va">margformula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">marginal.estimate</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="va">margformula</span>, data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                         dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span><span class="va">time</span>, shape <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">marginal.estimate</span><span class="op">$</span><span class="va">scale</span>, </span>
<span>                    scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">marginal.estimate</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">theta.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">me</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="va">margformula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">i</span>, <span class="op">]</span>, dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span><span class="va">time</span>, shape <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">me</span><span class="op">$</span><span class="va">scale</span>, </span>
<span>                    scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">me</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">POi</span> <span class="op">&lt;-</span> <span class="va">theta</span>  <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">theta</span> <span class="op">-</span> <span class="va">theta.i</span><span class="op">)</span></span>
<span>  <span class="va">POi</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now let us try it out by passing it to the <code>cumincglm</code>
function and compare to the default independence estimator:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitpara</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumincglm.html">cumincglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, time <span class="op">=</span> <span class="fl">2500</span>, </span>
<span>                  model.censoring <span class="op">=</span> <span class="va">pseudo_parametric</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">colon</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitdef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumincglm.html">cumincglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, time <span class="op">=</span> <span class="fl">2500</span>, </span>
<span>                  model.censoring <span class="op">=</span> <span class="st">"independent"</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">colon</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parametric <span class="op">=</span> <span class="va">fitpara</span>, default <span class="op">=</span> <span class="va">fitdef</span><span class="op">)</span>, </span>
<span>       <span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">parametric</th>
<th align="right">default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.5473823</td>
<td align="right">0.4891055</td>
</tr>
<tr class="even">
<td align="left">rxLev</td>
<td align="right">-0.0216382</td>
<td align="right">-0.0292873</td>
</tr>
<tr class="odd">
<td align="left">rxLev+5FU</td>
<td align="right">-0.1488142</td>
<td align="right">-0.1326516</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0.0008129</td>
<td align="right">-0.0102263</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.0004233</td>
<td align="right">0.0010047</td>
</tr>
</tbody>
</table>
<p>You can also refer to the function with a string, omitting the
“pseudo_” prefix, if you wish, e.g.,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumincglm.html">cumincglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, time <span class="op">=</span> <span class="fl">2500</span>, </span>
<span>                  model.censoring <span class="op">=</span> <span class="st">"parametric"</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">colon</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-infinitesimal-jackknife">Example 2: infinitesimal jackknife<a class="anchor" aria-label="anchor" href="#example-2-infinitesimal-jackknife"></a>
</h3>
<p>When the survival package version 3.0 was released, it became
possible to get the influence function values returned from some
estimation functions. These efficient influence functions are used in
the variance calculations, and they are related to pseudo observations.
More information is available in the “pseudo.Rnw” vignette of the
development version of survival. We can use this feature to create a
custom function for infinitesimal jackknife pseudo observations:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pseudo_infjack2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">time</span>, <span class="va">cause</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">data</span>,</span>
<span>                        <span class="va">type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cuminc"</span>, <span class="st">"survival"</span>, <span class="st">"rmean"</span><span class="op">)</span>,</span>
<span>                        <span class="va">formula.censoring</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">ipcw.method</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">marginal.estimate2</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">update.formula</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">.</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                             data <span class="op">=</span> <span class="va">data</span>, influence <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>     <span class="va">tdex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">time</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">marginal.estimate2</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>     <span class="va">pstate</span> <span class="op">&lt;-</span> <span class="va">marginal.estimate2</span><span class="op">$</span><span class="va">surv</span><span class="op">[</span><span class="va">tdex</span><span class="op">]</span></span>
<span></span>
<span>     <span class="co">## S(t) + (n)[S(t) -S_{-i}(t)]</span></span>
<span>     <span class="va">POi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">pstate</span>, nrow <span class="op">=</span> <span class="va">marginal.estimate2</span><span class="op">$</span><span class="va">n</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="op">(</span><span class="va">marginal.estimate2</span><span class="op">$</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span></span>
<span>         <span class="op">(</span><span class="va">marginal.estimate2</span><span class="op">$</span><span class="va">influence.surv</span><span class="op">[</span>, <span class="va">tdex</span><span class="op">]</span><span class="op">)</span></span>
<span>     </span>
<span>     <span class="va">POi</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that this computes pseudo observations for survival, rather than
the cumulative incidence, so to compare we can use the survival = TRUE
option. Now we try it out</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitinf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumincglm.html">cumincglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, time <span class="op">=</span> <span class="fl">2500</span>, </span>
<span>                  model.censoring <span class="op">=</span> <span class="st">"infjack2"</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">colon</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitdefsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumincglm.html">cumincglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, time <span class="op">=</span> <span class="fl">2500</span>, </span>
<span>                  survival <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">colon</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>infjack <span class="op">=</span> <span class="va">fitinf</span>, default <span class="op">=</span> <span class="va">fitdefsurv</span><span class="op">)</span>, </span>
<span>       <span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">infjack</th>
<th align="right">default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.5108264</td>
<td align="right">0.5108945</td>
</tr>
<tr class="even">
<td align="left">rxLev</td>
<td align="right">0.0292609</td>
<td align="right">0.0292873</td>
</tr>
<tr class="odd">
<td align="left">rxLev+5FU</td>
<td align="right">0.1326361</td>
<td align="right">0.1326516</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0.0102568</td>
<td align="right">0.0102263</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">-0.0010036</td>
<td align="right">-0.0010047</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This opens up a lot of possibilities for future extensions of
<code>eventglm</code>, and will also make it easier to maintain. Try it
out with different methods, and let us know what methods you are using
or would like to use.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael C Sachs, Erin E Gabriel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
