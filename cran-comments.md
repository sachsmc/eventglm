This is a resubmission that includes some new features and bugfixes. 

Test environments: 

- Win builder (release and dev)
- On Rhub:
    + Ubuntu 20.04, R-release
    + Fedora, R-devel
    + Debian R-devel
    
