This is a resubmission that includes some new features and bugfixes. 

Test environments: 

- Win builder (release and dev)
- Ubuntu 16.04.6 LTS (R version 4.0.2)
